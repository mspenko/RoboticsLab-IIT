import math
import numpy as np


def  FG_fn(ax,ay,az,wy,wz,phi,theta,psi,bx_f,by_f,bz_f,by_w,bz_w,tau_f,tau_w):
     #F_FN
     #    F = F_FN(AX,AY,AZ,BX_F,BY_F,BY_W,BZ_F,BZ_W,PHI,PSI,TAU_F,TAU_W,THETA,WY,WZ)


     t2 = math.cos(phi)
     t3 = math.sin(psi)
     t4 = math.cos(psi)
     t5 = math.sin(phi)
     t6 = math.sin(theta)
     t7 = az-bz_f
     t8 = math.cos(theta)
     t9 = ay-by_f
     t10 = ax-bx_f
     t11 = t2*t3
     t20 = t4*t5*t6
     t12 = t11-t20
     t13 = t3*t5
     t14 = t2*t4*t6
     t15 = t4*t5
     t22 = t2*t3*t6
     t16 = t15-t22
     t17 = t2*t4
     t18 = t3*t5*t6
     t19 = t17+t18
     t21 = t13+t14
     t23 = tan(theta)
     t24 = bz_w-wz
     t25 = by_w-wy
     t26 = t23**2
     t27 = t26+1.0
     t28 = 1.0/t8
     t29 = 1.0/t8**2
     shit = np.array([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,t7*t12+t9*t21,-t9*t16-t7*t19,t2*t8*t9-t5*t7*t8,-t2*t23*t25+t5*t23*t24,t2*t24+t5*t25,-t2*t25*t28+t5*t24*t28,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-t4*t6*t10+t2*t4*t7*t8+t4*t5*t8*t9,-t3*t6*t10+t2*t3*t7*t8+t3*t5*t8*t9,-t8*t10-t2*t6*t7-t5*t6*t9,-t2*t24*t27-t5*t25*t27,0.0,-t2*t6*t24*t29-t5*t6*t25*t29,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,t7*t16-t9*t19-t3*t8*t10,-t9*t12+t7*t21+t4*t8*t10,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-t4*t8,-t3*t8,t6,0.0,0.0,0.0,-tau_f,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,t12,-t17-t18,-t5*t8,0.0,0.0,0.0,0.0,-tau_f,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-t13-t14,t16,-t2*t8,0.0,0.0,0.0,0.0,0.0,-tau_f,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-1.0,0.0,0.0,0.0,0.0,0.0,-tau_w,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-t5*t23,-t2,-t5*t28,0.0,0.0,0.0,0.0,-tau_w,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-t2*t23,t5,-t2*t28,0.0,0.0,0.0,0.0,0.0,-tau_w])
     F = np.reshape(shit,[15,15])
     t2 = math.cos(psi)
     t3 = math.sin(phi)
     t4 = math.sin(psi)
     t5 = math.cos(phi)
     t6 = math.sin(theta)
     t7 = math.cos(theta)
     t8 = math.tan(theta)
     t9 = 1.0/t7
     shit2 = np.array([0.0,0.0,0.0,-t2*t7,-t4*t7,t6,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,t4*t5-t2*t3*t6,-t2*t5-t3*t4*t6,-t3*t7,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-t3*t4-t2*t5*t6,t2*t3-t4*t5*t6,-t5*t7,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-t3*t8,-t5,-t3*t9,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-t5*t8,t3,-t5*t9,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0])
     G = reshape(shit2,[15,12])
     return [F,G]
