% a=-1000:0.1:1000;
% b=zeros(size(a));
% for id = 1:length(a)
%     b(id)= obj.optimization_fn(a(id), fx_hat_dir, M_dir, obj.sigma_hat, params.alert_limit, params.m_F * obj.n_L_M );
% end
% 
% plot(a,b)

hess4 = @(x) -sum(abs(diag(sqrtm(obj.PX./dT)*[zeros(6,15);zeros(6,6),...
    [(ay-x(5))*(cos(x(1))*sin(x(3))-sin(x(1))*sin(x(2))*cos(x(3)))-(az-x(6))*(sin(x(1))*sin(x(3))+cos(x(1))*sin(x(2))*cos(x(3))),(ay-x(5))*cos(x(1))*cos(x(2))*cos(x(3))-(az-x(6))*sin(x(1))*cos(x(2))*cos(x(3)),(ay-x(5))*(sin(x(1))*cos(x(3))-cos(x(1))*sin(x(2))*sin(x(3)))+(az-x(6))*(cos(x(1))*cos(x(3))+sin(x(1))*sin(x(2))*sin(x(3))),0,-(sin(x(1))*sin(x(3))+cos(x(1))*sin(x(2))*cos(x(3))),-(cos(x(1))*sin(x(3))-sin(x(1))*sin(x(2))*cos(x(3)));...
    (ay-x(5))*cos(x(1))*cos(x(2))*cos(x(3))-(az-x(6))*sin(x(1))*cos(x(2))*cos(x(3)),-(ax-x(4))*cos(x(2))*cos(x(3))-(ay-x(5))*sin(x(1))*sin(x(2))*cos(x(3))-(az-x(6))*cos(x(1))*sin(x(2))*cos(x(3)),(ax-x(4))*sin(x(2))*sin(x(3))-(ay-x(5))*sin(x(1))*cos(x(2))*sin(x(3))-(az-x(6))*cos(x(1))*cos(x(2))*sin(x(3)),sin(x(2))*cos(x(3)),-sin(x(1))*cos(x(2))*cos(x(3)),-cos(x(1))*cos(x(2))*cos(x(3));...
    (ay-x(5))*(sin(x(1))*cos(x(3))-cos(x(1))*sin(x(2))*sin(x(3)))+(az-x(6))*(cos(x(1))*cos(x(3))+sin(x(1))*sin(x(2))*sin(x(3))),(ax-x(4))*sin(x(2))*sin(x(3))-(ay-x(5))*sin(x(1))*cos(x(2))*sin(x(3))-(az-x(6))*cos(x(1))*cos(x(2))*sin(x(3)),-(ax-x(4))*cos(x(2))*cos(x(3))-(ay-x(5))*(sin(x(1))*sin(x(2))*cos(x(3))-cos(x(1))*sin(x(3)))-(az-x(6))*(sin(x(1))*sin(x(3))+cos(x(1))*sin(x(2))*cos(x(3))),cos(x(2))*sin(x(3)),sin(x(1))*sin(x(2))*sin(x(3))+cos(x(1))*cos(x(3)),cos(x(1))*sin(x(2))*sin(x(3))-sin(x(1))*cos(x(3));...
    0,sin(x(2))*cos(x(3)),cos(x(2))*sin(x(3)),0,0,0;...
    -(sin(x(1))*sin(x(3))+cos(x(1))*sin(x(2))*cos(x(3))),-sin(x(1))*cos(x(2))*cos(x(3)),sin(x(1))*sin(x(2))*sin(x(3))+cos(x(1))*cos(x(3)),0,0,0;...
    -(cos(x(1))*sin(x(3))-sin(x(1))*sin(x(2))*cos(x(3))),-cos(x(1))*cos(x(2))*cos(x(3)),cos(x(1))*sin(x(2))*sin(x(3))-sin(x(1))*cos(x(3)),0,0,0],...
    zeros(6,3);zeros(3,15)]*sqrtm(obj.PX./dT))));
